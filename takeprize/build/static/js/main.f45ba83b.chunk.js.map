{"version":3,"sources":["component/Wheel-light/index.jsx","component/Wheel-list/index.jsx","component/Wheel-pointer/index.jsx","component/Twinkle/index.jsx","component/Showprize/index.jsx","App.js","index.js"],"names":["Wheel_light","React","useState","colorA","colorB","lightcolors","setlight","useEffect","timer","setInterval","clearInterval","li4A","res","i","push","style","background","li4B","className","initdata","Array","fill","map","nanoid","WheelList","data","setdata","prize","setprize","angle","transition","rotate_animate","setrotate","a","axios","result","prize_info","response","n","length","prize_name","isprize","prize_id","pop","fetchData","token","PubSub","subscribe","msg","item","prize_index","setTimeout","publish","unsubscribe","id","transform","index","src","alt","WheelPointer","takeprize","onClick","Twinkle","twinkle_animate","settwinkle","animation","Showprize","prizemsg","setprizemsg","display","setdisplay","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.f45ba83b.chunk.js","sourcesContent":["import React, { useEffect } from 'react'\r\nimport './index.css'\r\n\r\nexport default function Wheel_light() {\r\n    const [lightcolors,setlight] = React.useState({colorA:'#fff7e8',colorB:'#e37815'});\r\n    //设置定时器，让A组、B组灯交替闪烁\r\n    React.useEffect(() => {\r\n        const timer=setInterval(()=>{\r\n            setlight(({colorA,colorB})=>{return {colorA:colorB,colorB:colorA}});\r\n        },500);\r\n        return () => {\r\n            clearInterval(timer);\r\n        }\r\n    }, [lightcolors])\r\n    //A组灯光\r\n    const li4A=()=>{\r\n        const res=[];\r\n        for(let i=0;i<4;i++){\r\n            res.push(<i key={i} style={{background:lightcolors.colorA}}></i>);\r\n        }\r\n        return res;\r\n    }\r\n    //B组灯光\r\n    const li4B=()=>{\r\n        const res=[];\r\n        for(let i=0;i<4;i++){\r\n            res.push(<i key={i} style={{background:lightcolors.colorB}}></i>);\r\n        }\r\n        return res;\r\n    }\r\n    return (\r\n        // 外层闪烁\r\n        <ul className=\"wheel-light\">\r\n            <li>{li4B()}</li>\r\n            <li>{li4A()}</li>\r\n            <li>{li4B()}</li>\r\n            <li>{li4A()}</li>\r\n            <li>{li4B()}</li>\r\n            <li>{li4A()}</li>\r\n        </ul>\r\n    )\r\n}","import React,{useState,useEffect} from 'react'\r\nimport axios from 'axios';\r\nimport './index.css'\r\nimport { nanoid } from 'nanoid';\r\nimport PubSub from 'pubsub-js';\r\n\r\n//包含6个唯一id的数组，用来生成奖项\r\nconst initdata = new Array(6).fill(0).map(()=>nanoid());\r\nexport default function WheelList() {\r\n    //奖品信息\r\n    const [data, setdata] = useState([]);\r\n    //奖品index和中奖消息\r\n    const [prize,setprize] = useState();\r\n    // 旋转动画\r\n    const [rotate_animate,setrotate] = useState({angle:0,transition:'none'});\r\n    //从后台获取需要进行展示的奖品信息，并且保证为6个\r\n    \r\n    useEffect(() => {\r\n        const fetchData=async ()=>{\r\n            // 获取奖品信息\r\n            const result = await axios('https://qc1hz1.fn.thelarkcloud.com/prizeinfo');\r\n            const prize_info = result.data.response;\r\n            // 计算奖品数量，保证其为6个\r\n            const n=prize_info.length;\r\n            if(n<6){\r\n                for(let i=n;i<6;i++){\r\n                    prize_info.push({prize_name: \"谢谢参与\", isprize: false,prize_id:nanoid()});\r\n                }   \r\n            }\r\n            if(n>6){\r\n                while(prize_info.length>6){\r\n                    prize_info.pop();\r\n                }\r\n            }\r\n            setdata(prize_info);\r\n        }\r\n        fetchData();\r\n    }, [])\r\n    \r\n    //订阅消息：收到消息后进行旋转\r\n    useEffect(() => {\r\n        const token = PubSub.subscribe('Prize',(msg,item)=>{\r\n            // 保存奖品index和中奖消息msg\r\n            setprize(item);\r\n            // 计算要旋转的角度并旋转\r\n            const angle=-item.prize_index*60+3600;\r\n            setrotate({angle:angle,transition:'all 5s ease-out'});\r\n            //旋转完成后\r\n            setTimeout(() => {\r\n                //对角度进行处理，以便下次旋转\r\n                setrotate({angle:angle%360,transition:'none'});\r\n                //通知闪烁,同时把中奖消息发送过去\r\n                PubSub.publish('Twinkle',item.msg);\r\n            }, 5000);\r\n        })\r\n        return () => {\r\n            PubSub.unsubscribe(token);\r\n        }\r\n    }, [prize,rotate_animate])\r\n\r\n    return (\r\n        //中间奖品\r\n        <ul id=\"wheel\" className=\"wheel-list\" style={{\r\n            transform:`rotate(${rotate_animate.angle}deg)`,\r\n            transition:rotate_animate.transition\r\n        }} >\r\n            {\r\n                initdata.map((item,index)=>(\r\n                    <li key={item} >\r\n                        <i></i>\r\n                        <div className=\"prize\">\r\n                            <p>{data[index]?data[index].prize_name:\"\"}</p>\r\n                            <img src={`/images/prize_img${index+1}.png`} alt=\"\" />\r\n                        </div>\r\n                    </li>\r\n                ))\r\n            }\r\n        </ul>\r\n    )\r\n}\r\n","import React from 'react'\r\nimport './index.css'\r\nimport axios from 'axios'\r\nimport PubSub from 'pubsub-js'\r\n\r\nexport default function WheelPointer() {\r\n    //点击按钮后从后台获取奖品index和中奖消息msg，通知Wheel-list进行旋转\r\n    const takeprize = async ()=>{\r\n        const result = await axios('https://qc1hz1.fn.thelarkcloud.com/takePrize');\r\n        PubSub.publish('Prize',result.data);\r\n    }\r\n    return (    \r\n        // 中心指针   \r\n        <div id=\"pointer\" className=\"wheel-pointer\">\r\n            <div id=\"button\" className=\"button\" onClick={takeprize} >\r\n                <strong>抽</strong>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n","import React,{useState,useEffect} from 'react'\r\nimport PubSub from 'pubsub-js';\r\nimport './index.css'\r\n\r\nexport default function Twinkle() {\r\n    //闪烁动画状态\r\n    const [twinkle_animate,settwinkle]=useState();\r\n    //订阅消息：收到消息后进行闪烁动画，之后通知Showprize展示奖品信息\r\n    useEffect(() => {\r\n        const token=PubSub.subscribe('Twinkle',(msg,item)=>{\r\n            // 进行闪烁动画\r\n            settwinkle('twinkle 0.8s');\r\n            // 通知Showprize展示奖品信息\r\n            setTimeout(() => {\r\n                settwinkle('none');\r\n                // 通知展示中奖消息\r\n                PubSub.publish('Showprize',item);\r\n            }, 1000);\r\n        })\r\n        return () => {\r\n            PubSub.unsubscribe(token);\r\n        }\r\n    }, [twinkle_animate])\r\n    return (\r\n        // 中奖后闪烁\r\n        <div className=\"twinkle-box\">\r\n            <div id=\"twinkle\" className=\"twinkle\" style={{animation:twinkle_animate}} ></div>\r\n        </div>\r\n    )\r\n}\r\n","import React,{useEffect,useState} from 'react'\r\nimport PubSub from 'pubsub-js'\r\nimport './index.css'\r\n\r\nexport default function Showprize() {\r\n    const [prizemsg,setprizemsg]=useState(\"\");\r\n    const [display,setdisplay]=useState();\r\n    // 订阅消息：收到消息后设置中奖消息，弹出中奖信息\r\n    useEffect(() => {\r\n        const token= PubSub.subscribe('Showprize',(msg,item)=>{\r\n            //设置中奖消息\r\n            setprizemsg(item);\r\n            //弹出中奖信息\r\n            setdisplay('block');\r\n        })\r\n        return () => {\r\n            PubSub.unsubscribe(token);\r\n        }\r\n    }, [prizemsg])\r\n    //关闭中奖信息\r\n    const close=()=>{\r\n        setdisplay('none');\r\n    }\r\n    return (\r\n        // 遮罩层+弹出奖品\r\n        <>\r\n            {/* 遮罩层 */}\r\n            <div className=\"mask\" style={{display:display}} ></div>\r\n            {/* 弹出奖品 */}\r\n            <div className=\"show-prize\" style={{display:display}} >\r\n                <img src=\"./images/prize.png\" alt=\"\" className=\"prize-container\"/>\r\n                <div className=\"prize-info\">{prizemsg}</div>\r\n                <img src=\"./images/close.png\" alt=\"\" className=\"close\" onClick={close} />\r\n            </div>\r\n        </>\r\n    )\r\n}\r\n","import './App.css';\nimport Wheellight from './component/Wheel-light';\nimport WheelList from './component/Wheel-list';\nimport WheelPointer from './component/Wheel-pointer';\nimport Twinkle from './component/Twinkle';\nimport Showprize from './component/Showprize';\n\nfunction App() {\n  return (\n    <>\n      {/* 抽奖轮盘：外层闪烁+中间奖品+中心指针+中奖后闪烁 */}\n      <div className=\"wheel\">\n        <Wheellight/>\n        <WheelList/>\n        <WheelPointer/>\n        <Twinkle/>\n      </div>\n      {/* 遮罩层+弹出奖品 */}\n      <Showprize/>\n    </>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App';\nimport 'lib-flexible'\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}